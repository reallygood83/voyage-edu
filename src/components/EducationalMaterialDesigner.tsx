'use client';

import { useState, useEffect } from 'react';
import { TravelPlan, PromotionalMaterial } from '@/types';
import { EducationalContent, EducationAIEngine, ContentQualityMetrics } from '@/lib/educationAI';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';

interface EducationalMaterialDesignerProps {
  educationalContent: EducationalContent;
  travelPlan: TravelPlan;
  onSave: (material: PromotionalMaterial) => void;
  educationSettings: {
    level: 'elementary' | 'middle' | 'high';
    grade: number;
    subject: string;
    learningStyle: string;
    groupSize: string;
  };
}

const EducationalMaterialDesigner = ({
  educationalContent,
  travelPlan,
  onSave,
  educationSettings
}: EducationalMaterialDesignerProps) => {
  const [selectedTemplate, setSelectedTemplate] = useState<string>('interactive_worksheet');
  const [qualityMetrics, setQualityMetrics] = useState<ContentQualityMetrics | null>(null);
  const [isGenerating, setIsGenerating] = useState(false);
  const [generatedHTML, setGeneratedHTML] = useState<string>('');

  // ÏΩòÌÖêÏ∏† ÌíàÏßà Î∂ÑÏÑù
  useEffect(() => {
    if (educationalContent) {
      analyzeContentQuality();
    }
  }, [educationalContent, educationSettings]);

  const analyzeContentQuality = () => {
    const contentText = educationalContent.contentSections
      .map(section => section.content)
      .join(' ');

    const metrics = EducationAIEngine.analyzeEducationalFitness(
      contentText,
      educationSettings.level,
      educationSettings.grade,
      educationSettings.subject
    );

    setQualityMetrics(metrics);
  };

  // ÍµêÏú°ÏûêÎ£å ÌÖúÌîåÎ¶ø Î™©Î°ù
  const educationalTemplates = [
    {
      id: 'interactive_worksheet',
      name: 'üìù ÏÉÅÌò∏ÏûëÏö© ÏõåÌÅ¨ÏãúÌä∏',
      description: 'Ï≤¥ÌÅ¨Î∞ïÏä§, ÎπàÏπ∏ Ï±ÑÏö∞Í∏∞, ÌÄ¥Ï¶àÍ∞Ä Ìè¨Ìï®Îêú Ïù∏ÌÑ∞ÎûôÌã∞Î∏å ÌïôÏäµÏßÄ',
      features: ['Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏', 'ÎπàÏπ∏ Ï±ÑÏö∞Í∏∞', 'ÏÑ†ÌÉùÌòï Î¨∏Ï†ú', 'Í∑∏Î¶¨Í∏∞ ÏòÅÏó≠'],
      level: ['elementary', 'middle']
    },
    {
      id: 'learning_journey',
      name: 'üó∫Ô∏è ÌïôÏäµ Ïó¨Ï†ï Îßµ',
      description: 'Í≤åÏûÑÌôîÎêú ÌïôÏäµ Í≤ΩÎ°úÎ°ú Îã®Í≥ÑÎ≥Ñ ÎØ∏ÏÖòÏùÑ ÏôÑÎ£åÌïòÎäî ÌòïÌÉú',
      features: ['Îã®Í≥ÑÎ≥Ñ ÎØ∏ÏÖò', 'ÏßÑÌñâÎ•† ÌëúÏãú', 'Î≥¥ÏÉÅ ÏãúÏä§ÌÖú', 'ÏãúÍ∞ÅÏ†Å Îßµ'],
      level: ['elementary']
    },
    {
      id: 'research_guide',
      name: 'üîç ÌÉêÍµ¨ ÌôúÎèô Í∞ÄÏù¥Îìú',
      description: 'Ï≤¥Í≥ÑÏ†ÅÏù∏ Ï°∞ÏÇ¨ÏôÄ Î∂ÑÏÑùÏùÑ ÏúÑÌïú Ïó∞Íµ¨ ÌôúÎèô ÌÖúÌîåÎ¶ø',
      features: ['Í∞ÄÏÑ§ ÏÑ§Ï†ï', 'ÏûêÎ£å ÏàòÏßë', 'Î∂ÑÏÑù ÌãÄ', 'Í≤∞Î°† ÎèÑÏ∂ú'],
      level: ['middle', 'high']
    },
    {
      id: 'collaborative_project',
      name: 'üë• ÌòëÎ†• ÌîÑÎ°úÏ†ùÌä∏',
      description: 'ÌåÄ Îã®ÏúÑÎ°ú ÏßÑÌñâÌïòÎäî ÌòëÎ†• ÌïôÏäµ ÌîÑÎ°úÏ†ùÌä∏ Í∞ÄÏù¥Îìú',
      features: ['Ïó≠Ìï† Î∂ÑÎã¥', 'Í≥µÎèô ÏûëÏóÖ', 'ÏÉÅÌò∏ ÌèâÍ∞Ä', 'Î∞úÌëú Ï§ÄÎπÑ'],
      level: ['middle', 'high']
    },
    {
      id: 'assessment_portfolio',
      name: 'üìä ÌèâÍ∞Ä Ìè¨Ìä∏Ìè¥Î¶¨Ïò§',
      description: 'Îã§ÏñëÌïú ÌèâÍ∞Ä ÎèÑÍµ¨Í∞Ä ÌÜµÌï©Îêú Ï¢ÖÌï© ÌèâÍ∞Ä ÏûêÎ£å',
      features: ['ÏûêÍ∏∞ÌèâÍ∞Ä', 'ÎèôÎ£åÌèâÍ∞Ä', 'Í¥ÄÏ∞∞ÌèâÍ∞Ä', 'ÏÑ±Ï∞∞ÏùºÏßÄ'],
      level: ['elementary', 'middle', 'high']
    }
  ];

  // ÌòÑÏû¨ ÌïôÏäµ ÏàòÏ§ÄÏóê ÎßûÎäî ÌÖúÌîåÎ¶ø ÌïÑÌÑ∞ÎßÅ
  const availableTemplates = educationalTemplates.filter(template =>
    template.level.includes(educationSettings.level)
  );

  // HTML ÍµêÏú°ÏûêÎ£å ÏÉùÏÑ±
  const generateEducationalMaterial = async () => {
    setIsGenerating(true);
    
    try {
      const template = availableTemplates.find(t => t.id === selectedTemplate);
      if (!template) return;

      let htmlContent = '';

      switch (selectedTemplate) {
        case 'interactive_worksheet':
          htmlContent = generateInteractiveWorksheet();
          break;
        case 'learning_journey':
          htmlContent = generateLearningJourney();
          break;
        case 'research_guide':
          htmlContent = generateResearchGuide();
          break;
        case 'collaborative_project':
          htmlContent = generateCollaborativeProject();
          break;
        case 'assessment_portfolio':
          htmlContent = generateAssessmentPortfolio();
          break;
        default:
          htmlContent = generateInteractiveWorksheet();
      }

      setGeneratedHTML(htmlContent);

      // PromotionalMaterial ÌòïÌÉúÎ°ú Ï†ÄÏû•
      const material: PromotionalMaterial = {
        id: `edu_${Date.now()}`,
        travelPlanId: travelPlan.id,
        type: 'brochure', // ÍµêÏú°ÏûêÎ£åÎäî brochure ÌÉÄÏûÖÏúºÎ°ú Ï†ÄÏû•
        title: `${educationalContent.title} - ${template.name}`,
        description: `${educationSettings.level} ${educationSettings.grade}ÌïôÎÖÑ ${educationSettings.subject} ÍµêÍ≥º Ïó∞Í≥Ñ ÌïôÏäµÏûêÎ£å`,
        imageUrl: undefined,
        content: htmlContent,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      };

      onSave(material);

    } catch (error) {
      console.error('ÍµêÏú°ÏûêÎ£å ÏÉùÏÑ± Ïã§Ìå®:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  // ÏÉÅÌò∏ÏûëÏö© ÏõåÌÅ¨ÏãúÌä∏ ÏÉùÏÑ±
  const generateInteractiveWorksheet = (): string => {
    const destinations = travelPlan.cities || [];
    const objectives = educationalContent.learningObjectives.slice(0, 3);

    return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${educationalContent.title} - ÏÉÅÌò∏ÏûëÏö© ÏõåÌÅ¨ÏãúÌä∏</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .worksheet {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        .title {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        .info-box {
            background: #f8f9ff;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .section {
            margin: 30px 0;
            padding: 25px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            background: #fafafa;
        }
        .section h3 {
            color: #667eea;
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .section h3::before {
            content: "üìç";
            margin-right: 10px;
            font-size: 1.2em;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .checkbox {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
        }
        .fill-blank {
            border-bottom: 2px solid #667eea;
            min-width: 150px;
            display: inline-block;
            margin: 0 5px;
            padding: 5px 10px;
            background: #f0f0f0;
        }
        .quiz-section {
            background: #fff8e1;
            border: 2px solid #ffc107;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        .quiz-question {
            font-weight: bold;
            margin-bottom: 15px;
            color: #e65100;
        }
        .quiz-options {
            margin-left: 20px;
        }
        .quiz-option {
            margin: 10px 0;
            display: flex;
            align-items: center;
        }
        .drawing-area {
            border: 2px dashed #667eea;
            min-height: 150px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f4ff;
            border-radius: 10px;
            color: #667eea;
            font-size: 1.1em;
        }
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .achievement-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9em;
            font-weight: bold;
        }
        .learning-objectives {
            background: #e8f5e8;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .destinations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .destination-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e0e0e0;
            transition: transform 0.3s ease;
        }
        .destination-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
        }
        @media print {
            body { background: white; }
            .worksheet { box-shadow: none; }
        }
    </style>
    <script>
        function updateProgress() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const checked = document.querySelectorAll('input[type="checkbox"]:checked');
            const progress = (checked.length / checkboxes.length) * 100;
            
            const progressBar = document.querySelector('.progress-fill');
            if (progressBar) {
                progressBar.style.width = progress + '%';
                progressBar.textContent = Math.round(progress) + '%';
            }
        }
        
        function showAchievement(title) {
            alert('üéâ Ï∂ïÌïòÌï©ÎãàÎã§! "' + title + '" Îã¨ÏÑ±ÌñàÏäµÎãàÎã§!');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', updateProgress);
            });
        });
    </script>
</head>
<body>
    <div class="worksheet">
        <div class="header">
            <h1 class="title">üåç ${educationalContent.title}</h1>
            <p class="subtitle">${educationSettings.level} ${educationSettings.grade}ÌïôÎÖÑ ${educationSettings.subject} ÍµêÍ≥º Ïó∞Í≥Ñ ÌïôÏäµ</p>
            <div class="info-box">
                <strong>üìö ÌïôÏäµ Î™©Ìëú:</strong> ${objectives.join(', ')}
            </div>
        </div>

        <div class="learning-objectives">
            <h3>üéØ Ïù¥Î≤à ÏãúÍ∞ÑÏóê Î∞∞Ïö∏ ÎÇ¥Ïö©</h3>
            ${objectives.map((obj, i) => `
                <div class="checkbox-item">
                    <input type="checkbox" class="checkbox" id="obj${i}">
                    <label for="obj${i}">${obj}</label>
                </div>
            `).join('')}
        </div>

        <div class="section">
            <h3>üó∫Ô∏è Ïó¨ÌñâÌï† ÎÇòÎùºÎì§ ÏïåÏïÑÎ≥¥Í∏∞</h3>
            <div class="destinations-grid">
                ${destinations.map(dest => `
                    <div class="destination-card">
                        <h4>üìç ${dest}</h4>
                        <div class="fill-blank" contenteditable="true">ÌäπÏßï Ï†ÅÍ∏∞</div>
                        <div style="margin-top: 10px;">
                            <input type="checkbox" id="dest_${dest}"> 
                            <label for="dest_${dest}">Ï°∞ÏÇ¨ ÏôÑÎ£å</label>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>

        <div class="quiz-section">
            <h3>üß© ÌÄ¥Ï¶à ÌÉÄÏûÑ!</h3>
            <div class="quiz-question">Q1. ${destinations[0] || 'ÏÑ†ÌÉùÌïú ÎÇòÎùº'}ÏóêÏÑú Í∞ÄÏû• Ïú†Î™ÖÌïú ÏùåÏãùÏùÄ Î¨¥ÏóáÏùºÍπåÏöî?</div>
            <div class="quiz-options">
                <div class="quiz-option">
                    <input type="radio" name="q1" id="q1a"> <label for="q1a">‚ë† ÍπÄÏπò</label>
                </div>
                <div class="quiz-option">
                    <input type="radio" name="q1" id="q1b"> <label for="q1b">‚ë° Ïä§Ïãú</label>
                </div>
                <div class="quiz-option">
                    <input type="radio" name="q1" id="q1c"> <label for="q1c">‚ë¢ ÌååÏä§ÌÉÄ</label>
                </div>
            </div>
        </div>

        <div class="section">
            <h3>‚úèÔ∏è ÎÇòÎßåÏùò Ïó¨Ìñâ Í≥ÑÌöç Í∑∏Î¶¨Í∏∞</h3>
            <p>Í∞ÄÍ≥† Ïã∂ÏùÄ Í≥≥Í≥º ÌïòÍ≥† Ïã∂ÏùÄ ÏùºÏùÑ Í∑∏Î¶ºÏúºÎ°ú Í∑∏Î†§Î≥¥ÏÑ∏Ïöî!</p>
            <div class="drawing-area">
                üé® Ïó¨Í∏∞Ïóê Í∑∏Î¶ºÏùÑ Í∑∏Î†§Ï£ºÏÑ∏Ïöî
            </div>
        </div>

        <div class="section">
            <h3>üìù ÌïôÏäµ Ï†ïÎ¶¨ÌïòÍ∏∞</h3>
            <p><strong>1. Ïò§Îäò Í∞ÄÏû• Ïû¨ÎØ∏ÏûàÏóàÎçò Í≤É:</strong></p>
            <div class="fill-blank" contenteditable="true" style="width: 100%; min-height: 50px;"></div>
            
            <p><strong>2. Îçî ÏïåÍ≥† Ïã∂ÏùÄ Í≤É:</strong></p>
            <div class="fill-blank" contenteditable="true" style="width: 100%; min-height: 50px;"></div>
            
            <p><strong>3. ÏπúÍµ¨Îì§ÏóêÍ≤å ÏÜåÍ∞úÌïòÍ≥† Ïã∂ÏùÄ Í≤É:</strong></p>
            <div class="fill-blank" contenteditable="true" style="width: 100%; min-height: 50px;"></div>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <h3>üèÜ ÌïôÏäµ ÏßÑÌñâÎ•†</h3>
            <div class="progress-bar">
                <div class="progress-fill">0%</div>
            </div>
            <div style="margin-top: 20px;">
                <span class="achievement-badge">üåü ÌÉêÌóòÍ∞Ä</span>
                <span class="achievement-badge">üó∫Ô∏è ÏßÄÎ¶¨Î∞ïÏÇ¨</span>
                <span class="achievement-badge">üé® Ï∞ΩÏùòÏôï</span>
            </div>
        </div>

        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
            <p style="color: #666;">Voyage EduÏóêÏÑú Ï†úÏûëÎêú ÍµêÏú°ÏûêÎ£åÏûÖÎãàÎã§. üìö‚ú®</p>
        </div>
    </div>
</body>
</html>`;
  };

  // ÌïôÏäµ Ïó¨Ï†ï Îßµ ÏÉùÏÑ±
  const generateLearningJourney = (): string => {
    return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${educationalContent.title} - ÌïôÏäµ Ïó¨Ï†ï Îßµ</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
        }
        .journey-map {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .map-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .journey-path {
            display: flex;
            flex-direction: column;
            gap: 30px;
            position: relative;
        }
        .mission-station {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 20px;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .mission-station:hover {
            transform: scale(1.02);
        }
        .mission-icon {
            font-size: 3em;
            margin-right: 20px;
        }
        .mission-content {
            flex: 1;
        }
        .mission-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .mission-description {
            opacity: 0.9;
            line-height: 1.4;
        }
        .mission-status {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            margin-left: 20px;
        }
        .completed {
            background: #4caf50;
        }
        .current {
            background: #ff9800;
            animation: pulse 2s infinite;
        }
        .locked {
            background: #757575;
            opacity: 0.6;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        .rewards-section {
            background: #fff3e0;
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            text-align: center;
        }
        .reward-badge {
            display: inline-block;
            background: #ff9800;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            font-weight: bold;
        }
    </style>
    <script>
        function completeMission(missionId) {
            const mission = document.getElementById(missionId);
            const status = mission.querySelector('.mission-status');
            
            mission.classList.remove('current');
            mission.classList.add('completed');
            status.textContent = '‚úÖ ÏôÑÎ£å';
            
            // Îã§Ïùå ÎØ∏ÏÖò ÌôúÏÑ±Ìôî
            const nextMission = mission.nextElementSibling;
            if (nextMission && nextMission.classList.contains('locked')) {
                nextMission.classList.remove('locked');
                nextMission.classList.add('current');
                nextMission.querySelector('.mission-status').textContent = 'üìç ÌòÑÏû¨ ÎØ∏ÏÖò';
            }
            
            updateProgress();
        }
        
        function updateProgress() {
            const total = document.querySelectorAll('.mission-station').length;
            const completed = document.querySelectorAll('.completed').length;
            const progress = (completed / total) * 100;
            
            document.getElementById('progress').textContent = Math.round(progress) + '%';
        }
    </script>
</head>
<body>
    <div class="journey-map">
        <div class="map-header">
            <h1>üó∫Ô∏è ${educationalContent.title} ÌïôÏäµ Ïó¨Ï†ï</h1>
            <p>ÎØ∏ÏÖòÏùÑ ÌïòÎÇòÏî© ÏôÑÎ£åÌïòÎ©∞ ÏÑ∏Í≥Ñ Ïó¨Ìñâ Ï†ÑÎ¨∏Í∞ÄÍ∞Ä ÎêòÏñ¥Î≥¥ÏÑ∏Ïöî!</p>
            <h3>ÏßÑÌñâÎ•†: <span id="progress">0%</span></h3>
        </div>

        <div class="journey-path">
            <div class="mission-station current" id="mission1" onclick="completeMission('mission1')">
                <div class="mission-icon">üöÄ</div>
                <div class="mission-content">
                    <div class="mission-title">ÎØ∏ÏÖò 1: Ïó¨Ìñâ Ï§ÄÎπÑÌïòÍ∏∞</div>
                    <div class="mission-description">
                        ÏÑ∏Í≥Ñ ÏßÄÎèÑÏóêÏÑú Í∞ÄÍ≥† Ïã∂ÏùÄ ÎÇòÎùºÎ•º Ï∞æÏïÑÎ≥¥Í≥†, Í∏∞Î≥∏ Ï†ïÎ≥¥Î•º Ï°∞ÏÇ¨Ìï¥Î≥¥ÏÑ∏Ïöî.
                    </div>
                </div>
                <div class="mission-status">üìç ÌòÑÏû¨ ÎØ∏ÏÖò</div>
            </div>

            <div class="mission-station locked" id="mission2" onclick="completeMission('mission2')">
                <div class="mission-icon">üéí</div>
                <div class="mission-content">
                    <div class="mission-title">ÎØ∏ÏÖò 2: Î¨∏Ìôî ÌÉêÌóòÌïòÍ∏∞</div>
                    <div class="mission-description">
                        Í∞Å ÎÇòÎùºÏùò Ï†ÑÌÜµ ÏùåÏãù, ÏùòÏÉÅ, Ï∂ïÏ†úÏóê ÎåÄÌï¥ ÏïåÏïÑÎ≥¥Í≥† Ï†ïÎ¶¨Ìï¥Î≥¥ÏÑ∏Ïöî.
                    </div>
                </div>
                <div class="mission-status">üîí Ïû†ÍπÄ</div>
            </div>

            <div class="mission-station locked" id="mission3" onclick="completeMission('mission3')">
                <div class="mission-icon">üèõÔ∏è</div>
                <div class="mission-content">
                    <div class="mission-title">ÎØ∏ÏÖò 3: Ïó≠ÏÇ¨ Ïó¨ÌñâÌïòÍ∏∞</div>
                    <div class="mission-description">
                        Í∞Å ÎÇòÎùºÏùò Ïú†Î™ÖÌïú Ïó≠ÏÇ¨Ï†Å Ïû•ÏÜåÏôÄ Ïù¥ÏïºÍ∏∞Î•º Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî.
                    </div>
                </div>
                <div class="mission-status">üîí Ïû†ÍπÄ</div>
            </div>

            <div class="mission-station locked" id="mission4" onclick="completeMission('mission4')">
                <div class="mission-icon">üé®</div>
                <div class="mission-content">
                    <div class="mission-title">ÎØ∏ÏÖò 4: Ïó¨Ìñâ Í≥ÑÌöç ÎßåÎì§Í∏∞</div>
                    <div class="mission-description">
                        Î∞∞Ïö¥ ÎÇ¥Ïö©ÏùÑ Î∞îÌÉïÏúºÎ°ú ÎÇòÎßåÏùò ÏÑ∏Í≥Ñ Ïó¨Ìñâ Í≥ÑÌöçÏùÑ ÏÑ∏ÏõåÎ≥¥ÏÑ∏Ïöî.
                    </div>
                </div>
                <div class="mission-status">üîí Ïû†ÍπÄ</div>
            </div>

            <div class="mission-station locked" id="mission5" onclick="completeMission('mission5')">
                <div class="mission-icon">üèÜ</div>
                <div class="mission-content">
                    <div class="mission-title">ÎØ∏ÏÖò 5: Ïó¨Ìñâ Ï†ÑÎ¨∏Í∞Ä ÎêòÍ∏∞</div>
                    <div class="mission-description">
                        ÏπúÍµ¨Îì§ÏóêÍ≤å Ïó¨Ìñâ Í≥ÑÌöçÏùÑ Î∞úÌëúÌïòÍ≥† ÏÑ∏Í≥Ñ Ïó¨Ìñâ Ï†ÑÎ¨∏Í∞Ä ÏûêÍ≤©ÏùÑ ÌöçÎìùÌïòÏÑ∏Ïöî!
                    </div>
                </div>
                <div class="mission-status">üîí Ïû†ÍπÄ</div>
            </div>
        </div>

        <div class="rewards-section">
            <h3>üèÜ ÌöçÎìùÌï† Ïàò ÏûàÎäî Î≥¥ÏÉÅ</h3>
            <div class="reward-badge">üåü ÌÉêÌóòÍ∞Ä Î±ÉÏßÄ</div>
            <div class="reward-badge">üó∫Ô∏è ÏßÄÎ¶¨ Î∞ïÏÇ¨ Î±ÉÏßÄ</div>
            <div class="reward-badge">üé® Ï∞ΩÏùòÏôï Î±ÉÏßÄ</div>
            <div class="reward-badge">üèÜ Ïó¨Ìñâ Ï†ÑÎ¨∏Í∞Ä Î±ÉÏßÄ</div>
        </div>
    </div>
</body>
</html>`;
  };

  // ÌÉêÍµ¨ ÌôúÎèô Í∞ÄÏù¥Îìú ÏÉùÏÑ±
  const generateResearchGuide = (): string => {
    return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${educationalContent.title} - ÌÉêÍµ¨ ÌôúÎèô Í∞ÄÏù¥Îìú</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            min-height: 100vh;
        }
        .research-guide {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .guide-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #74b9ff;
        }
        .research-step {
            background: #f8f9ff;
            border-left: 5px solid #74b9ff;
            padding: 25px;
            margin: 25px 0;
            border-radius: 10px;
        }
        .step-number {
            background: #74b9ff;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            float: left;
            margin-right: 20px;
        }
        .step-content {
            margin-left: 60px;
        }
        .step-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 10px;
        }
        .research-form {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .form-field {
            margin: 15px 0;
        }
        .form-field label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #2d3436;
        }
        .form-field input, .form-field textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
        }
        .form-field textarea {
            min-height: 100px;
            resize: vertical;
        }
        .analysis-framework {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .framework-box {
            background: #e8f4ff;
            border: 2px solid #74b9ff;
            border-radius: 10px;
            padding: 20px;
        }
        .sources-checklist {
            background: #fff8e1;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .checklist-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        .checklist-item input {
            margin-right: 10px;
        }
        .conclusion-template {
            background: #e8f5e8;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="research-guide">
        <div class="guide-header">
            <h1>üîç ${educationalContent.title} ÌÉêÍµ¨ ÌôúÎèô Í∞ÄÏù¥Îìú</h1>
            <p>Ï≤¥Í≥ÑÏ†ÅÏù∏ Ï°∞ÏÇ¨ÏôÄ Î∂ÑÏÑùÏùÑ ÌÜµÌï¥ ÍπäÏù¥ ÏûàÎäî ÌïôÏäµÏùÑ Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
        </div>

        <div class="research-step">
            <div class="step-number">1</div>
            <div class="step-content">
                <div class="step-title">üéØ Ïó∞Íµ¨ Î¨∏Ï†ú ÏÑ§Ï†ïÌïòÍ∏∞</div>
                <p>Í∂ÅÍ∏àÌïú Ï†êÏù¥ÎÇò Ìï¥Í≤∞ÌïòÍ≥† Ïã∂ÏùÄ Î¨∏Ï†úÎ•º Î™ÖÌôïÌïòÍ≤å Ï†ïÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                
                <div class="research-form">
                    <div class="form-field">
                        <label>Ï£ºÏöî Ïó∞Íµ¨ ÏßàÎ¨∏:</label>
                        <textarea placeholder="Ïòà: Ïôú ÏùºÎ≥∏Í≥º ÌïúÍµ≠Ïùò Ï†ÑÌÜµ Í±¥Ï∂ïÏñëÏãùÏù¥ Îã§Î•ºÍπå?"></textarea>
                    </div>
                    <div class="form-field">
                        <label>ÏÑ∏Î∂Ä ÏßàÎ¨∏ 1:</label>
                        <input type="text" placeholder="Ï≤´ Î≤àÏß∏ ÌïòÏúÑ ÏßàÎ¨∏ÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî">
                    </div>
                    <div class="form-field">
                        <label>ÏÑ∏Î∂Ä ÏßàÎ¨∏ 2:</label>
                        <input type="text" placeholder="Îëê Î≤àÏß∏ ÌïòÏúÑ ÏßàÎ¨∏ÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî">
                    </div>
                </div>
            </div>
        </div>

        <div class="research-step">
            <div class="step-number">2</div>
            <div class="step-content">
                <div class="step-title">üìö ÏûêÎ£å ÏàòÏßëÌïòÍ∏∞</div>
                <p>Ïã†Î¢∞Ìï† Ïàò ÏûàÎäî Îã§ÏñëÌïú ÏûêÎ£åÎ•º ÏàòÏßëÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                
                <div class="sources-checklist">
                    <h4>üìã ÏûêÎ£å ÏàòÏßë Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏</h4>
                    <div class="checklist-item">
                        <input type="checkbox" id="book"> <label for="book">üìñ ÎèÑÏÑúÍ¥Ä Ï±Ö ÎòêÎäî Î∞±Í≥ºÏÇ¨Ï†Ñ</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="website"> <label for="website">üåê Í≥µÏã†Î†• ÏûàÎäî ÏõπÏÇ¨Ïù¥Ìä∏</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="news"> <label for="news">üì∞ Ïã†Î¨∏ Í∏∞ÏÇ¨</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="video"> <label for="video">üé• ÍµêÏú°Ïö© ÎèôÏòÅÏÉÅ</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="interview"> <label for="interview">üé§ Ï†ÑÎ¨∏Í∞Ä Ïù∏ÌÑ∞Î∑∞</label>
                    </div>
                </div>

                <div class="research-form">
                    <div class="form-field">
                        <label>ÏàòÏßëÌïú ÏûêÎ£å Î™©Î°ù:</label>
                        <textarea placeholder="ÏûêÎ£åÏùò Ï†úÎ™©, Ï∂úÏ≤ò, ÌïµÏã¨ ÎÇ¥Ïö©ÏùÑ Ï†ïÎ¶¨Ìï¥Ï£ºÏÑ∏Ïöî"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="research-step">
            <div class="step-number">3</div>
            <div class="step-content">
                <div class="step-title">üî¨ Î∂ÑÏÑùÌïòÍ∏∞</div>
                <p>ÏàòÏßëÌïú ÏûêÎ£åÎ•º Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú Î∂ÑÏÑùÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                
                <div class="analysis-framework">
                    <div class="framework-box">
                        <h4>üìä ÎπÑÍµê Î∂ÑÏÑù</h4>
                        <div class="form-field">
                            <label>Í≥µÌÜµÏ†ê:</label>
                            <textarea rows="3"></textarea>
                        </div>
                        <div class="form-field">
                            <label>Ï∞®Ïù¥Ï†ê:</label>
                            <textarea rows="3"></textarea>
                        </div>
                    </div>
                    
                    <div class="framework-box">
                        <h4>üîç ÏõêÏù∏Í≥º Í≤∞Í≥º</h4>
                        <div class="form-field">
                            <label>ÏõêÏù∏:</label>
                            <textarea rows="3"></textarea>
                        </div>
                        <div class="form-field">
                            <label>Í≤∞Í≥º:</label>
                            <textarea rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="research-step">
            <div class="step-number">4</div>
            <div class="step-content">
                <div class="step-title">üìù Í≤∞Î°† ÎèÑÏ∂úÌïòÍ∏∞</div>
                <p>Î∂ÑÏÑùÌïú ÎÇ¥Ïö©ÏùÑ Î∞îÌÉïÏúºÎ°ú Ïó∞Íµ¨ ÏßàÎ¨∏Ïóê ÎåÄÌïú ÎãµÏùÑ Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî.</p>
                
                <div class="conclusion-template">
                    <div class="form-field">
                        <label>üéØ Ïó∞Íµ¨ ÏßàÎ¨∏Ïóê ÎåÄÌïú Îãµ:</label>
                        <textarea placeholder="Ï£ºÏöî Ïó∞Íµ¨ ÏßàÎ¨∏Ïóê ÎåÄÌïú ÎãµÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî"></textarea>
                    </div>
                    <div class="form-field">
                        <label>üí° ÏÉàÎ°≠Í≤å ÏïåÍ≤å Îêú Ï†ê:</label>
                        <textarea placeholder="Ïù¥Î≤à Ïó∞Íµ¨Î•º ÌÜµÌï¥ ÏÉàÎ°≠Í≤å ÏïåÍ≤å Îêú Ï†êÎì§ÏùÑ Ï†ïÎ¶¨Ìï¥Î≥¥ÏÑ∏Ïöî"></textarea>
                    </div>
                    <div class="form-field">
                        <label>‚ùì Ï∂îÍ∞ÄÎ°ú Í∂ÅÍ∏àÌïú Ï†ê:</label>
                        <textarea placeholder="Îçî ÍπäÏù¥ Ïó∞Íµ¨Ìï¥Î≥¥Í≥† Ïã∂ÏùÄ Ï£ºÏ†úÎÇò Í∂ÅÍ∏àÌïú Ï†êÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî"></textarea>
                    </div>
                    <div class="form-field">
                        <label>üåü Ïù¥ Ïó∞Íµ¨Ïùò ÏùòÎØ∏:</label>
                        <textarea placeholder="Ïù¥Î≤à Ïó∞Íµ¨Í∞Ä Ïôú Ï§ëÏöîÌïòÍ≥† Ïñ¥Îñ§ ÏùòÎØ∏Í∞Ä ÏûàÎäîÏßÄ Ïç®Î≥¥ÏÑ∏Ïöî"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
            <h3>üèÜ Ïó∞Íµ¨ ÏôÑÎ£å!</h3>
            <p>ÏàòÍ≥†ÌïòÏÖ®ÏäµÎãàÎã§. Ïù¥Ï†ú Ïó¨Îü¨Î∂ÑÏùÄ ÏßÑÏ†ïÌïú ÌÉêÍµ¨ÏûêÏûÖÎãàÎã§! üîç‚ú®</p>
            <p style="color: #666; font-size: 0.9em;">Voyage Edu ÌÉêÍµ¨ ÌôúÎèô Í∞ÄÏù¥Îìú</p>
        </div>
    </div>
</body>
</html>`;
  };

  // ÌòëÎ†• ÌîÑÎ°úÏ†ùÌä∏ Í∞ÄÏù¥Îìú ÏÉùÏÑ±
  const generateCollaborativeProject = (): string => {
    const projectTitle = `${educationalContent.title} - ÌåÄ ÌîÑÎ°úÏ†ùÌä∏`;
    const teamRoles = [
      { name: 'ÌÉêÌóòÎåÄÏû•', icon: 'üèÉ‚Äç‚ôÇÔ∏è', description: 'ÌåÄÏùÑ Ïù¥ÎÅåÍ≥† ÌîÑÎ°úÏ†ùÌä∏ ÏùºÏ†ïÏùÑ Í¥ÄÎ¶¨Ìï¥Ïöî' },
      { name: 'ÏûêÎ£åÏàòÏßëÍ∞Ä', icon: 'üîç', description: 'Ï†ïÎ≥¥Î•º Ï∞æÍ≥† Ï†ïÎ¶¨ÌïòÎäî Ï†ÑÎ¨∏Í∞ÄÏòàÏöî' },
      { name: 'Ï∞ΩÏûëÍ∞Ä', icon: 'üé®', description: 'Ï∞ΩÏùòÏ†ÅÏù∏ Í≤∞Í≥ºÎ¨ºÏùÑ ÎßåÎìúÎäî Îã¥ÎãπÏù¥ÏóêÏöî' },
      { name: 'Î∞úÌëúÏûê', icon: 'üé§', description: 'ÌåÄÏùò Í≤∞Í≥ºÎ•º Î©ãÏßÄÍ≤å Î∞úÌëúÌï¥Ïöî' }
    ];

    return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${projectTitle}</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .project-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .project-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px;
            color: white;
        }

        .project-title {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            font-weight: 800;
        }

        .project-subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin: 0;
        }

        .team-section {
            margin: 40px 0;
            padding: 30px;
            background: #f8f9ff;
            border-radius: 20px;
            border-left: 6px solid #667eea;
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin: 0 0 25px 0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .team-roles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .role-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .role-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.15);
        }

        .role-icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
        }

        .role-name {
            font-size: 1.3em;
            font-weight: 700;
            color: #333;
            margin: 0 0 10px 0;
        }

        .role-description {
            color: #666;
            font-size: 0.95em;
            line-height: 1.4;
        }

        .project-phases {
            display: grid;
            gap: 25px;
            margin: 30px 0;
        }

        .phase-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 5px solid #f093fb;
        }

        .phase-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #333;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .phase-activities {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .phase-activities li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
            color: #555;
        }

        .phase-activities li:before {
            content: '‚úÖ';
            position: absolute;
            left: 0;
        }

        .collaboration-tools {
            background: #fff5f5;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #f093fb;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .tool-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .evaluation-criteria {
            background: #f0fff4;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #48bb78;
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .criteria-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #48bb78;
        }

        .criteria-title {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .criteria-description {
            color: #4a5568;
            font-size: 0.9em;
        }

        .timeline {
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .timeline-day {
            background: #667eea;
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-weight: 700;
            margin-right: 20px;
            min-width: 80px;
            text-align: center;
        }

        .timeline-content {
            flex: 1;
        }

        @media (max-width: 768px) {
            .project-container {
                margin: 10px;
                padding: 20px;
            }
            
            .project-title {
                font-size: 2em;
            }
            
            .team-roles {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="project-container">
        <div class="project-header">
            <h1 class="project-title">${projectTitle}</h1>
            <p class="project-subtitle">Ìï®Íªò ÎßåÎì§Ïñ¥Í∞ÄÎäî ÏÑ∏Í≥Ñ Î¨∏Ìôî ÌÉêÌóò ÌîÑÎ°úÏ†ùÌä∏</p>
        </div>

        <div class="team-section">
            <h2 class="section-title">üë• Ïö∞Î¶¨ ÌåÄ Ïó≠Ìï† Î∂ÑÎã¥</h2>
            <div class="team-roles">
                ${teamRoles.map(role => `
                    <div class="role-card">
                        <span class="role-icon">${role.icon}</span>
                        <h3 class="role-name">${role.name}</h3>
                        <p class="role-description">${role.description}</p>
                    </div>
                `).join('')}
            </div>
        </div>

        <div class="team-section">
            <h2 class="section-title">üóìÔ∏è ÌîÑÎ°úÏ†ùÌä∏ ÏßÑÌñâ Îã®Í≥Ñ</h2>
            <div class="project-phases">
                <div class="phase-card">
                    <h3 class="phase-title">üìã 1Îã®Í≥Ñ: Í≥ÑÌöç ÏÑ∏Ïö∞Í∏∞</h3>
                    <ul class="phase-activities">
                        <li>ÌåÄÏõê Ïó≠Ìï† Ï†ïÌïòÍ∏∞</li>
                        <li>Ïó¨Ìñâ Î™©Ï†ÅÏßÄ ÏÑ†Ï†ïÌïòÍ∏∞</li>
                        <li>Ï°∞ÏÇ¨Ìï† Î¨∏Ìôî ÏöîÏÜå Ï†ïÌïòÍ∏∞</li>
                        <li>ÏùºÏ†ï Í≥ÑÌöç ÏÑ∏Ïö∞Í∏∞</li>
                    </ul>
                </div>
                
                <div class="phase-card">
                    <h3 class="phase-title">üîç 2Îã®Í≥Ñ: ÏûêÎ£å Ï°∞ÏÇ¨ÌïòÍ∏∞</h3>
                    <ul class="phase-activities">
                        <li>Î™©Ï†ÅÏßÄ Í∏∞Î≥∏ Ï†ïÎ≥¥ ÏàòÏßë</li>
                        <li>Ï†ÑÌÜµ Î¨∏ÌôîÏôÄ ÌòÑÎåÄ Î¨∏Ìôî Ï°∞ÏÇ¨</li>
                        <li>ÏùåÏãù, ÏùòÏÉÅ, Ï∂ïÏ†ú Îì± Ï°∞ÏÇ¨</li>
                        <li>Ïö∞Î¶¨ÎÇòÎùºÏôÄ ÎπÑÍµê Î∂ÑÏÑù</li>
                    </ul>
                </div>
                
                <div class="phase-card">
                    <h3 class="phase-title">üé® 3Îã®Í≥Ñ: Í≤∞Í≥ºÎ¨º ÎßåÎì§Í∏∞</h3>
                    <ul class="phase-activities">
                        <li>Ïó¨Ìñâ Í≥ÑÌöçÏÑú ÏûëÏÑ±</li>
                        <li>Î¨∏Ìôî ÎπÑÍµê Ìè¨Ïä§ÌÑ∞ Ï†úÏûë</li>
                        <li>Ï†ÑÌÜµ ÏöîÎ¶¨ Ï≤¥Ìóò Í≥ÑÌöç</li>
                        <li>Î∞úÌëú ÏûêÎ£å Ï§ÄÎπÑ</li>
                    </ul>
                </div>
                
                <div class="phase-card">
                    <h3 class="phase-title">üé§ 4Îã®Í≥Ñ: Î∞úÌëúÌïòÍ∏∞</h3>
                    <ul class="phase-activities">
                        <li>ÌåÄ Î∞úÌëú ÏßÑÌñâ</li>
                        <li>Îã§Î•∏ ÌåÄÍ≥º Ï†ïÎ≥¥ Í≥µÏú†</li>
                        <li>ÏÉÅÌò∏ ÌîºÎìúÎ∞± Ï£ºÍ≥†Î∞õÍ∏∞</li>
                        <li>ÌîÑÎ°úÏ†ùÌä∏ ÏÑ±Ï∞∞ÌïòÍ∏∞</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="collaboration-tools">
            <h2 class="section-title">üõ†Ô∏è ÌòëÏóÖ ÎèÑÍµ¨ ÌôúÏö©</h2>
            <div class="tool-grid">
                <div class="tool-item">
                    <h4>üìù Íµ¨Í∏Ä Î¨∏ÏÑú</h4>
                    <p>Ìï®Íªò ÏûêÎ£å Ï†ïÎ¶¨</p>
                </div>
                <div class="tool-item">
                    <h4>üìä Ìå®Îì§Î¶ø</h4>
                    <p>ÏïÑÏù¥ÎîîÏñ¥ Í≥µÏú†</p>
                </div>
                <div class="tool-item">
                    <h4>üé® Ïπ∏Î∞î</h4>
                    <p>Ìè¨Ïä§ÌÑ∞ Ï†úÏûë</p>
                </div>
                <div class="tool-item">
                    <h4>üí¨ ÌÅ¥ÎûòÏä§Î£∏</h4>
                    <p>ÏÜåÌÜµÍ≥º ÌîºÎìúÎ∞±</p>
                </div>
            </div>
        </div>

        <div class="evaluation-criteria">
            <h2 class="section-title">‚≠ê ÌèâÍ∞Ä Í∏∞Ï§Ä</h2>
            <div class="criteria-grid">
                <div class="criteria-item">
                    <div class="criteria-title">ÌòëÎ†•Í≥º ÏÜåÌÜµ</div>
                    <div class="criteria-description">ÌåÄÏõêÎì§Í≥º Ïûò ÌòëÎ†•ÌïòÍ≥† Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú ÏÜåÌÜµÌñàÎÇòÏöî?</div>
                </div>
                <div class="criteria-item">
                    <div class="criteria-title">Ï∞ΩÏùòÏ†Å ÏÇ¨Í≥†</div>
                    <div class="criteria-description">ÎèÖÏ∞ΩÏ†ÅÏù¥Í≥† Ï∞ΩÏùòÏ†ÅÏù∏ ÏïÑÏù¥ÎîîÏñ¥Î•º Ï†úÏãúÌñàÎÇòÏöî?</div>
                </div>
                <div class="criteria-item">
                    <div class="criteria-title">ÏûêÎ£å ÌôúÏö©</div>
                    <div class="criteria-description">Îã§ÏñëÌïú ÏûêÎ£åÎ•º Ïûò ÏàòÏßëÌïòÍ≥† ÌôúÏö©ÌñàÎÇòÏöî?</div>
                </div>
                <div class="criteria-item">
                    <div class="criteria-title">Î¨∏Ï†ú Ìï¥Í≤∞</div>
                    <div class="criteria-description">Î¨∏Ï†ú ÏÉÅÌô©ÏùÑ Ïûò Ìï¥Í≤∞ÌïòÍ≥† ÎåÄÏïàÏùÑ Ï†úÏãúÌñàÎÇòÏöî?</div>
                </div>
            </div>
        </div>

        <div class="timeline">
            <h2 class="section-title">üìÖ Í∂åÏû• ÏùºÏ†ïÌëú</h2>
            <div class="timeline-item">
                <div class="timeline-day">1-2Ïùº</div>
                <div class="timeline-content">
                    <strong>ÌåÄ Íµ¨ÏÑ± Î∞è Í≥ÑÌöç</strong><br>
                    Ïó≠Ìï† Î∂ÑÎã¥, Î™©Ï†ÅÏßÄ ÏÑ†Ï†ï, Ï°∞ÏÇ¨ Í≥ÑÌöç ÏàòÎ¶Ω
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-day">3-5Ïùº</div>
                <div class="timeline-content">
                    <strong>ÏûêÎ£å Ï°∞ÏÇ¨</strong><br>
                    Î¨∏Ìôî, Ïó≠ÏÇ¨, ÏßÄÎ¶¨ Ï†ïÎ≥¥ ÏàòÏßë Î∞è Ï†ïÎ¶¨
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-day">6-8Ïùº</div>
                <div class="timeline-content">
                    <strong>Í≤∞Í≥ºÎ¨º Ï†úÏûë</strong><br>
                    Î∞úÌëú ÏûêÎ£å, Ìè¨Ïä§ÌÑ∞, Ï≤¥Ìóò ÌôúÎèô Ï§ÄÎπÑ
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-day">9-10Ïùº</div>
                <div class="timeline-content">
                    <strong>Î∞úÌëú Î∞è Í≥µÏú†</strong><br>
                    ÌåÄ Î∞úÌëú, ÌîºÎìúÎ∞±, ÏÑ±Ï∞∞ ÌôúÎèô
                </div>
            </div>
        </div>
    </div>
</body>
</html>`;
  };

  // ÌèâÍ∞Ä Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ ÏÉùÏÑ±
  const generateAssessmentPortfolio = (): string => {
    const assessmentTitle = `${educationalContent.title} - ÌïôÏäµ Ìè¨Ìä∏Ìè¥Î¶¨Ïò§`;
    
    return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${assessmentTitle}</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            margin: 0;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .portfolio-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .portfolio-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            border-radius: 20px;
            color: white;
        }

        .portfolio-title {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            font-weight: 800;
        }

        .portfolio-subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin: 0;
        }

        .learning-objectives {
            background: #f0f8ff;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border-left: 5px solid #4a90e2;
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin: 0 0 20px 0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .objectives-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .objective-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-top: 4px solid #4a90e2;
        }

        .objective-title {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .objective-description {
            color: #4a5568;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .assessment-rubric {
            background: #fff9f0;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #f6ad55;
        }

        .rubric-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .rubric-table th {
            background: #4a90e2;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 700;
        }

        .rubric-table td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
            text-align: center;
            vertical-align: top;
        }

        .rubric-table tr:last-child td {
            border-bottom: none;
        }

        .rubric-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .level-excellent { background: #c6f6d5 !important; }
        .level-good { background: #fed7d7 !important; }
        .level-needs-improvement { background: #fefcbf !important; }

        .self-assessment {
            background: #f0fff4;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #48bb78;
        }

        .assessment-items {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .assessment-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .assessment-question {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .rating-scale {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .rating-option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 80px;
        }

        .rating-option:hover {
            border-color: #4a90e2;
            background: #e6f3ff;
        }

        .reflection-area {
            width: 100%;
            min-height: 80px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-family: inherit;
            font-size: 0.95em;
            resize: vertical;
        }

        .reflection-area:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .evidence-collection {
            background: #fdf2f8;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #f687b3;
        }

        .evidence-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .evidence-type {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            border-top: 4px solid #f687b3;
        }

        .evidence-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: block;
        }

        .evidence-title {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .evidence-description {
            color: #4a5568;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .growth-tracking {
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .growth-chart {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .chart-title {
            font-weight: 700;
            color: #2d3748;
        }

        .progress-bars {
            display: grid;
            gap: 15px;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .progress-label {
            min-width: 120px;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9em;
        }

        .progress-bar {
            flex: 1;
            height: 25px;
            background: #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4a90e2, #63b3ed);
            border-radius: 12px;
            transition: width 0.5s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: 600;
            color: white;
            font-size: 0.8em;
        }

        @media (max-width: 768px) {
            .portfolio-container {
                margin: 10px;
                padding: 20px;
            }
            
            .portfolio-title {
                font-size: 2em;
            }
            
            .objectives-grid {
                grid-template-columns: 1fr;
            }
            
            .evidence-types {
                grid-template-columns: 1fr;
            }
            
            .rating-scale {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="portfolio-container">
        <div class="portfolio-header">
            <h1 class="portfolio-title">${assessmentTitle}</h1>
            <p class="portfolio-subtitle">ÎÇòÎßåÏùò ÌïôÏäµ ÏÑ±Ïû• Í∏∞Î°ùÏû•</p>
        </div>

        <div class="learning-objectives">
            <h2 class="section-title">üéØ ÌïôÏäµ Î™©Ìëú</h2>
            <div class="objectives-grid">
                ${educationalContent.learningObjectives.map((objective, index) => `
                    <div class="objective-card">
                        <div class="objective-title">Î™©Ìëú ${index + 1}</div>
                        <div class="objective-description">${objective}</div>
                    </div>
                `).join('')}
            </div>
        </div>

        <div class="assessment-rubric">
            <h2 class="section-title">üìä ÌèâÍ∞Ä Í∏∞Ï§ÄÌëú</h2>
            <table class="rubric-table">
                <thead>
                    <tr>
                        <th style="width: 25%;">ÌèâÍ∞Ä ÏòÅÏó≠</th>
                        <th style="width: 25%;">Ïö∞Ïàò (4Ï†ê)</th>
                        <th style="width: 25%;">ÏñëÌò∏ (3Ï†ê)</th>
                        <th style="width: 25%;">Î≥¥ÏôÑ ÌïÑÏöî (2Ï†ê)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Î¨∏Ìôî Ïù¥Ìï¥ÎèÑ</strong></td>
                        <td class="level-excellent">Îã§ÏñëÌïú Î¨∏ÌôîÏ†Å ÌäπÏßïÏùÑ ÍπäÏù¥ ÏûàÍ≤å Ïù¥Ìï¥ÌïòÍ≥† ÎπÑÍµê Î∂ÑÏÑùÌï®</td>
                        <td class="level-good">Î¨∏ÌôîÏ†Å ÌäπÏßïÏùÑ Ïù¥Ìï¥ÌïòÍ≥† Í∏∞Î≥∏Ï†ÅÏù∏ ÎπÑÍµêÍ∞Ä Í∞ÄÎä•Ìï®</td>
                        <td class="level-needs-improvement">Î¨∏ÌôîÏ†Å ÌäπÏßïÏóê ÎåÄÌïú Ïù¥Ìï¥Í∞Ä Î∂ÄÏ°±Ìï®</td>
                    </tr>
                    <tr>
                        <td><strong>Ï°∞ÏÇ¨ Îä•Î†•</strong></td>
                        <td class="level-excellent">Îã§ÏñëÌïú ÏûêÎ£åÎ•º ÏàòÏßëÌïòÍ≥† Ïã†Î¢∞ÏÑ± ÏûàÍ≤å Ï†ïÎ¶¨Ìï®</td>
                        <td class="level-good">Í∏∞Î≥∏Ï†ÅÏù∏ ÏûêÎ£å ÏàòÏßëÍ≥º Ï†ïÎ¶¨Í∞Ä Í∞ÄÎä•Ìï®</td>
                        <td class="level-needs-improvement">ÏûêÎ£å ÏàòÏßëÍ≥º Ï†ïÎ¶¨Ïóê ÎèÑÏõÄÏù¥ ÌïÑÏöîÌï®</td>
                    </tr>
                    <tr>
                        <td><strong>Ï∞ΩÏùòÏ†Å ÌëúÌòÑ</strong></td>
                        <td class="level-excellent">ÎèÖÏ∞ΩÏ†ÅÏù¥Í≥† Ï∞ΩÏùòÏ†ÅÏù∏ Î∞©Î≤ïÏúºÎ°ú ÌëúÌòÑÌï®</td>
                        <td class="level-good">Ï†ÅÏ†àÌïú Î∞©Î≤ïÏúºÎ°ú ÎÇ¥Ïö©ÏùÑ ÌëúÌòÑÌï®</td>
                        <td class="level-needs-improvement">ÌëúÌòÑ Î∞©Î≤ïÏù¥ Îã®Ï°∞Î°≠Í±∞ÎÇò ÎØ∏Ìù°Ìï®</td>
                    </tr>
                    <tr>
                        <td><strong>ÌòëÎ†•Í≥º ÏÜåÌÜµ</strong></td>
                        <td class="level-excellent">Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú ÌòëÎ†•ÌïòÍ≥† Ìö®Í≥ºÏ†ÅÏúºÎ°ú ÏÜåÌÜµÌï®</td>
                        <td class="level-good">Í∏∞Î≥∏Ï†ÅÏù∏ ÌòëÎ†•Í≥º ÏÜåÌÜµÏù¥ Í∞ÄÎä•Ìï®</td>
                        <td class="level-needs-improvement">ÌòëÎ†•Í≥º ÏÜåÌÜµÏóê Ïñ¥Î†§ÏõÄÏùÑ Î≥¥ÏûÑ</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="self-assessment">
            <h2 class="section-title">ü§î ÏûêÍ∏∞ ÌèâÍ∞Ä</h2>
            <div class="assessment-items">
                <div class="assessment-item">
                    <div class="assessment-question">1. ÏÑ∏Í≥Ñ Ïó¨Îü¨ ÎÇòÎùºÏùò Î¨∏ÌôîÎ•º ÏñºÎßàÎÇò Ïûò Ïù¥Ìï¥ÌñàÎÇòÏöî?</div>
                    <div class="rating-scale">
                        <div class="rating-option">Îß§Ïö∞ ÏûòÌï®</div>
                        <div class="rating-option">ÏûòÌï®</div>
                        <div class="rating-option">Î≥¥ÌÜµ</div>
                        <div class="rating-option">ÎÖ∏Î†• ÌïÑÏöî</div>
                    </div>
                    <textarea class="reflection-area" placeholder="Íµ¨Ï≤¥Ï†ÅÏù∏ Ïù¥Ïú†ÎÇò ÏòàÏãúÎ•º Ïç®Î≥¥ÏÑ∏Ïöî..."></textarea>
                </div>
                
                <div class="assessment-item">
                    <div class="assessment-question">2. Ï°∞ÏÇ¨ ÌôúÎèôÏóê ÏñºÎßàÎÇò Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Ï∞∏Ïó¨ÌñàÎÇòÏöî?</div>
                    <div class="rating-scale">
                        <div class="rating-option">Îß§Ïö∞ Ï†ÅÍ∑πÏ†Å</div>
                        <div class="rating-option">Ï†ÅÍ∑πÏ†Å</div>
                        <div class="rating-option">Î≥¥ÌÜµ</div>
                        <div class="rating-option">ÏÜåÍ∑πÏ†Å</div>
                    </div>
                    <textarea class="reflection-area" placeholder="Ïñ¥Îñ§ Ï°∞ÏÇ¨ ÌôúÎèôÏùÑ ÌñàÎäîÏßÄ Ïç®Î≥¥ÏÑ∏Ïöî..."></textarea>
                </div>
                
                <div class="assessment-item">
                    <div class="assessment-question">3. ÌåÄ ÌôúÎèôÏóêÏÑú ÌòëÎ†•ÏùÑ ÏñºÎßàÎÇò ÏûòÌñàÎÇòÏöî?</div>
                    <div class="rating-scale">
                        <div class="rating-option">Îß§Ïö∞ ÏûòÌï®</div>
                        <div class="rating-option">ÏûòÌï®</div>
                        <div class="rating-option">Î≥¥ÌÜµ</div>
                        <div class="rating-option">ÎÖ∏Î†• ÌïÑÏöî</div>
                    </div>
                    <textarea class="reflection-area" placeholder="ÌåÄ ÌôúÎèôÏóêÏÑú Ïñ¥ÎñªÍ≤å ÌòëÎ†•ÌñàÎäîÏßÄ Ïç®Î≥¥ÏÑ∏Ïöî..."></textarea>
                </div>
                
                <div class="assessment-item">
                    <div class="assessment-question">4. Í∞ÄÏû• Í∏∞ÏñµÏóê ÎÇ®Îäî Í≤ÉÍ≥º Î∞∞Ïö¥ Ï†êÏùÄ Î¨¥ÏóáÏù∏Í∞ÄÏöî?</div>
                    <textarea class="reflection-area" placeholder="Í∞ÄÏû• Ïù∏ÏÉÅ ÍπäÏóàÎçò Î¨∏ÌôîÎÇò ÏÉàÎ°≠Í≤å ÏïåÍ≤å Îêú Ï†êÏùÑ Ïç®Î≥¥ÏÑ∏Ïöî..." style="min-height: 120px;"></textarea>
                </div>
            </div>
        </div>

        <div class="evidence-collection">
            <h2 class="section-title">üìÅ ÌïôÏäµ Ï¶ùÍ±∞ ÏûêÎ£å</h2>
            <div class="evidence-types">
                <div class="evidence-type">
                    <span class="evidence-icon">üìù</span>
                    <div class="evidence-title">Ï°∞ÏÇ¨ Î≥¥Í≥†ÏÑú</div>
                    <div class="evidence-description">ÎÇòÎùºÎ≥Ñ Î¨∏Ìôî Ï°∞ÏÇ¨ ÏûêÎ£åÏôÄ Ï†ïÎ¶¨Ìïú ÎÇ¥Ïö©</div>
                </div>
                <div class="evidence-type">
                    <span class="evidence-icon">üé®</span>
                    <div class="evidence-title">Ï∞ΩÏûëÎ¨º</div>
                    <div class="evidence-description">Ìè¨Ïä§ÌÑ∞, Í∑∏Î¶º, ÎßåÎì§Í∏∞ ÏûëÌíà Îì±</div>
                </div>
                <div class="evidence-type">
                    <span class="evidence-icon">üì∏</span>
                    <div class="evidence-title">ÌôúÎèô ÏÇ¨ÏßÑ</div>
                    <div class="evidence-description">ÏàòÏóÖ ÌôúÎèô, Ï≤¥Ìóò ÌôúÎèô ÏÇ¨ÏßÑ</div>
                </div>
                <div class="evidence-type">
                    <span class="evidence-icon">üé§</span>
                    <div class="evidence-title">Î∞úÌëú ÏûêÎ£å</div>
                    <div class="evidence-description">Î∞úÌëú Ïä¨ÎùºÏù¥Îìú, Î∞úÌëú ÏòÅÏÉÅ</div>
                </div>
                <div class="evidence-type">
                    <span class="evidence-icon">‚úçÔ∏è</span>
                    <div class="evidence-title">ÏÑ±Ï∞∞ ÏùºÏßÄ</div>
                    <div class="evidence-description">ÌïôÏäµ Í≥ºÏ†ïÍ≥º ÎäêÎÇÄ Ï†ê Í∏∞Î°ù</div>
                </div>
                <div class="evidence-type">
                    <span class="evidence-icon">üë•</span>
                    <div class="evidence-title">ÌòëÎ†• Í∏∞Î°ù</div>
                    <div class="evidence-description">ÌåÄ ÌôúÎèô Í≥ºÏ†ïÍ≥º Ïó≠Ìï† ÏàòÌñâ ÎÇ¥Ïö©</div>
                </div>
            </div>
        </div>

        <div class="growth-tracking">
            <h2 class="section-title">üìà ÏÑ±Ïû• Í∏∞Î°ù</h2>
            <div class="growth-chart">
                <div class="chart-header">
                    <div class="chart-title">ÌïôÏäµ ÏòÅÏó≠Î≥Ñ ÏÑ±Ïû•ÎèÑ</div>
                    <div style="font-size: 0.9em; color: #718096;">ÌÅ¥Î¶≠ÌïòÏó¨ Ï†êÏàòÎ•º Ï°∞Ï†ïÌïòÏÑ∏Ïöî</div>
                </div>
                <div class="progress-bars">
                    <div class="progress-item">
                        <div class="progress-label">Î¨∏Ìôî Ïù¥Ìï¥</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 75%;">
                                <div class="progress-text">75%</div>
                            </div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">Ï°∞ÏÇ¨ Îä•Î†•</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 80%;">
                                <div class="progress-text">80%</div>
                            </div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">Ï∞ΩÏùòÏ†Å ÌëúÌòÑ</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 70%;">
                                <div class="progress-text">70%</div>
                            </div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">ÌòëÎ†• ÏÜåÌÜµ</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%;">
                                <div class="progress-text">85%</div>
                            </div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">Î∞úÌëú Îä•Î†•</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 65%;">
                                <div class="progress-text">65%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÌèâÏ†ê ÏÑ†ÌÉù Í∏∞Îä•
        document.querySelectorAll('.rating-option').forEach(option => {
            option.addEventListener('click', function() {
                // Í∞ôÏùÄ Í∑∏Î£πÏùò Îã§Î•∏ ÏÑ†ÌÉù Ìï¥Ï†ú
                this.parentElement.querySelectorAll('.rating-option').forEach(el => {
                    el.style.background = '#f7fafc';
                    el.style.borderColor = '#e2e8f0';
                    el.style.color = '#2d3748';
                });
                
                // ÏÑ†ÌÉùÎêú Ìï≠Î™© Í∞ïÏ°∞
                this.style.background = '#4a90e2';
                this.style.borderColor = '#4a90e2';
                this.style.color = 'white';
            });
        });

        // ÏßÑÌñâÎ•† Î∞î ÌÅ¥Î¶≠ Í∏∞Îä•
        document.querySelectorAll('.progress-bar').forEach(bar => {
            bar.addEventListener('click', function(e) {
                const rect = this.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const percentage = Math.round((clickX / rect.width) * 100);
                
                const fill = this.querySelector('.progress-fill');
                const text = this.querySelector('.progress-text');
                
                fill.style.width = percentage + '%';
                text.textContent = percentage + '%';
            });
        });
    </script>
</body>
</html>`;
  };

  return (
    <div className="space-y-8">
      {/* ÌíàÏßà Î∂ÑÏÑù Í≤∞Í≥º */}
      {qualityMetrics && (
        <Card>
          <CardContent className="p-6">
            <h3 className="text-xl font-bold mb-4 text-gray-800">
              üìä ÍµêÏú° ÏΩòÌÖêÏ∏† ÌíàÏßà Î∂ÑÏÑù
            </h3>
            <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
              <div className="text-center">
                <div className="text-2xl font-bold text-blue-600">
                  {qualityMetrics.educationalAlignment}%
                </div>
                <div className="text-sm text-gray-600">ÍµêÏú°Í≥ºÏ†ï Ïó∞Í≥ÑÏÑ±</div>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-green-600">
                  {qualityMetrics.ageAppropriateness}%
                </div>
                <div className="text-sm text-gray-600">Ïó∞Î†π Ï†ÅÌï©ÏÑ±</div>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-purple-600">
                  {qualityMetrics.engagementLevel}%
                </div>
                <div className="text-sm text-gray-600">Ï∞∏Ïó¨ÎèÑ ÏòàÏÉÅ</div>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-orange-600">
                  {qualityMetrics.comprehensibility}%
                </div>
                <div className="text-sm text-gray-600">Ïù¥Ìï¥ Ïö©Ïù¥ÏÑ±</div>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-red-600">
                  {qualityMetrics.interactivity}%
                </div>
                <div className="text-sm text-gray-600">ÏÉÅÌò∏ÏûëÏö©ÏÑ±</div>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-indigo-600">
                  {qualityMetrics.overallScore}%
                </div>
                <div className="text-sm text-gray-600">Ï¢ÖÌï© Ï†êÏàò</div>
              </div>
            </div>
          </CardContent>
        </Card>
      )}

      {/* ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù */}
      <Card>
        <CardContent className="p-6">
          <h3 className="text-xl font-bold mb-4 text-gray-800">
            üé® ÍµêÏú°ÏûêÎ£å ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {availableTemplates.map((template) => (
              <button
                key={template.id}
                onClick={() => setSelectedTemplate(template.id)}
                className={`p-4 rounded-lg border-2 text-left transition-all ${
                  selectedTemplate === template.id
                    ? 'border-blue-500 bg-blue-50'
                    : 'border-gray-300 hover:border-gray-400'
                }`}
              >
                <h4 className="font-bold text-lg mb-2">{template.name}</h4>
                <p className="text-sm text-gray-600 mb-3">{template.description}</p>
                <div className="flex flex-wrap gap-1">
                  {template.features.map((feature, index) => (
                    <span
                      key={index}
                      className="text-xs bg-gray-100 px-2 py-1 rounded"
                    >
                      {feature}
                    </span>
                  ))}
                </div>
              </button>
            ))}
          </div>
        </CardContent>
      </Card>

      {/* ÏÉùÏÑ±Îêú ÏûêÎ£å ÎØ∏Î¶¨Î≥¥Í∏∞ */}
      {generatedHTML && (
        <Card>
          <CardContent className="p-6">
            <h3 className="text-xl font-bold mb-4 text-gray-800">
              üëÄ ÏÉùÏÑ±Îêú ÍµêÏú°ÏûêÎ£å ÎØ∏Î¶¨Î≥¥Í∏∞
            </h3>
            <div className="border-2 border-gray-300 rounded-lg p-4 max-h-96 overflow-y-auto">
              <iframe
                srcDoc={generatedHTML}
                className="w-full h-80 border-0"
                title="ÍµêÏú°ÏûêÎ£å ÎØ∏Î¶¨Î≥¥Í∏∞"
              />
            </div>
          </CardContent>
        </Card>
      )}

      {/* ÏÉùÏÑ± Î≤ÑÌäº */}
      <div className="text-center">
        <Button
          onClick={generateEducationalMaterial}
          disabled={isGenerating}
          className="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg transition-colors"
        >
          {isGenerating ? 'üîÑ ÏÉùÏÑ± Ï§ë...' : '‚ú® ÍµêÏú°ÏûêÎ£å ÏÉùÏÑ±ÌïòÍ∏∞'}
        </Button>
      </div>
    </div>
  );
};

export default EducationalMaterialDesigner;